<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Pomodoro Fusion</title>
  <link rel="icon" type="image/x-icon" href="favicon.ico">
  <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
  <link rel="stylesheet" href="../static/css/style.css">
</head>

<body>
  <main class="container">

    <div class="main-content-area">

      <header>
        <div class="header-main">
          <img id="logo" src="../static/img/pomodorsi.webp" alt="Pomodoro Fusion Logo" onerror="this.src='https://placehold.co/100x100/ff8c00/FFFFFF?text=P'">
          <h1>Pomodoro Fusion</h1>
        </div>
      </header>

      <section id="quote-box" aria-live="polite">
        "The secret of getting ahead is getting started." – Mark Twain
      </section>

      <section id="timer-section" aria-labelledby="timer-heading">
        <h2 id="timer-heading" class="visually-hidden">Timer Status</h2>
        <div id="timer-status" aria-live="polite">Ready</div>
        <div id="timer" aria-live="polite">25:00</div>
      </section>

      <div id="controls">
        <button id="startWorkBtn" aria-label="Start or Pause Work Timer">Start Work</button>
        <button id="startBreakBtn" class="hidden" aria-label="Start Break Timer">Start Break</button>
        <button id="skipBreakBtn" class="hidden" aria-label="Skip current break">Skip Break</button>
        <button id="finishEarlyBtn" class="hidden" aria-label="Finish current session early and log">Finish Early</button>
        <button id="voidPomoBtn" class="hidden" aria-label="Void current Pomodoro due to interruption">Void Pomo</button>
        <button id="resetBtn" aria-label="Reset Timer and current session cycle">Reset Cycle</button>
      </div>

      <section id="task-manager-section" aria-labelledby="task-manager-heading">
        <h2 id="task-manager-heading">Today's Tasks</h2>
        <form id="add-task-form">
            <input type="text" id="task-description-input" placeholder="Enter a new task..." required>
            <input type="number" id="task-estimate-input" value="1" min="1" max="10" title="Estimated Pomodoros">
            <button type="submit" title="Add Task"><i class="fas fa-plus"></i> Add</button>
        </form>
        <div id="task-list-container">
            <ul id="task-list">
                <!-- Tasks will be dynamically inserted here -->
            </ul>
        </div>
      </section>

      <section id="todays-progress-display" aria-labelledby="progress-heading">
        <h2 id="progress-heading">Today's Session Progress</h2>
        <div id="pomo-count">Today's sessions: 0</div>
        <div id="pomodoro-visual" aria-label="Visual indicator of completed sessions today"></div>
      </section>

      <section id="log-display-section" aria-labelledby="log-heading">
        <h2 id="log-heading">Completed Session Log</h2>
        <div class="log-options">
          <label for="showTodayOnly">
            <input type="checkbox" id="showTodayOnly" checked> Show Only Today's Sessions
          </label>
          <a class="button-link" href="/dashboard" target="_blank" rel="noopener noreferrer">Stats Dashboard</a>
          <a class="button-link" href="/tasks-dashboard" target="_blank" rel="noopener noreferrer">Task Dashboard</a>
        </div>
        <div class="log-container">
          <ul id="log" aria-live="polite">
            <li class="empty-log">Loading logs...</li>
          </ul>
        </div>
        <div class="log-controls">
          <button id="settingsBtn" aria-label="Open Timer Settings">Settings</button>
          <button id="deleteLogBtn" aria-label="Delete the last logged Pomodoro session">Delete Last Log</button>
          <a href="/logout" class="button-link" style="background: linear-gradient(145deg, #6c757d, #5a6268);">Logout</a>
        </div>
      </section>

      <div id="reward-quote" class="hidden" aria-live="polite"></div>
      <div id="api-status" aria-live="assertive"></div>

    </div>
  </main>
  <div id="settings-modal-container" aria-modal="true" role="dialog" aria-labelledby="settings-heading-modal">
    <form id="settings-form">
      <button type="button" id="closeSettingsBtn" aria-label="Close Settings">×</button>
      <fieldset>
        <legend id="settings-heading-modal">Timer Settings</legend>
        <div class="settings-grid">
          <label for="pomodoroLength">Work (mins):
            <input type="number" id="pomodoroLength" value="25" min="1" max="90">
          </label>
          <label for="breakLength">Short Break (mins):
            <input type="number" id="breakLength" value="5" min="1" max="30">
          </label>
          <label for="longBreakLength">Long Break (mins):
            <input type="number" id="longBreakLength" value="25" min="5" max="60">
          </label>
          <label for="longBreakInterval">Long Break After:
            <input type="number" id="longBreakInterval" value="4" min="1" max="10">
          </label>
        </div>
      </fieldset>
      <fieldset>
        <legend>Alarm Settings</legend>
        <div class="settings-grid">
          <label for="alarmLength">Alarm Duration (s):
            <input type="number" id="alarmLength" value="7" min="1" max="30">
          </label>
          <div class="volume-control">
            <label for="alarmVolume">Volume:</label>
            <input type="range" id="alarmVolume" name="volume" min="0" max="10" value="4">
            <span id="volumeValue">4</span>
          </div>
        </div>
      </fieldset>
      <fieldset>
        <legend>Notifications</legend>
        <div id="notification-control">
            <button type="button" id="enableNotificationsBtn">Enable Notifications</button>
        </div>
      </fieldset>
    </form>
  </div>
  <audio id="alarm-sound" src="../static/audio/alarm.mp3" preload="auto"></audio>
  <script src="../static/js/main.js"></script>
  
</body>
</html>
